---
title: "学习R之向量、数组和矩阵"
author: "数分进阶"
date: "3/1/2021"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = ">>", collapse = TRUE)
```

### 1. 向量
已经试过用冒号运算符 : 来创建从某个数到另一个数的数字序列，以及用 c 函数来拼接数值和向量，以创建更长的向量。总结如下:

```{r}
8.5:4.5

c(1, 1:3, c(5, 8), 13)
```

<br />
vector 函数能创建一个指定类型和长度的矢量。其结果中的值可为零、FALSE、空字符串，也可以直接使用每个类型的包装函数来创建。

```{r}
vector("numeric", 5)

numeric(5)

vector("logical", 5)

logical(5)

vector("character", 5)

character(5)
```

#### 1.1 序列
除了冒号运算符之外，还有几个其他函数能创建更为通用的序列。其中，seq 函数最常见， 能以许多不同的方式指定序列，同时还可以指定序列的步长。

```{r}
seq.int(3, 12)

seq.int(3, 12, 2)

seq.int(0.1, 0.01, -0.01)
```

#### 1.2 长度
所有的向量都有一个长度，它告诉我 们向量包含多少个元素。

```{r}
length(1:5)

length(c(TRUE, FALSE, NA))
```

需要注意的是字符向量，它们的长度为字符串的数目，而非每个字符串中字符数 的长度。对此，我们使用 nchar:

```{r}
sn <- c("Sheena", "leads", "Sheila", "needs")
length(sn)

nchar(sn)
```

#### 1.3 命名
R 向量的一大特性是能给每个元素命名。通常，标记元素可使代码可读性更强。你可以使 用name = value的形式在创建向量时为其指定名称。如果元素的名称是有效的，则无需被 引号括起来。你也可以只命名向量中的某些元素而忽略其他元素。

你也可以在向量创建后用 names 函数为元素添加名字。

```{r}
c(apple = 1, banana = 2, "kiwi fruit" = 3, 4)

x <- 1:4
names(x) <- c("apple", "bananas", "kiwi fruit", "")
```

#### 1.4 索引
通常，我们只要访问向量中的部分或个别元素。这就是所谓的索引，它用方括号 [] 来实 现，R 语言提供了如下多种索引方法：

- 给向量传入正数，它会返回此位置上的向量元素切片。它的第一个位置是 1(而不像其 他某些语言一样是 0)。
- 给向量传入负数，它会返回一个向量切片，它将包含除了这些位置以外的所有元素。
- 给向量传入一个逻辑向量，它会返回一个向量切片，里面只包含索引为 TRUE 的元素。
- 对于已命名的向量，给向量传入命名的字符向量，将会返回向量中包含这些名字的元素切片。

```{r}
x <- (1:5) ^ 2

x[c(1, 3, 5)]

x[c(-2, -4)]

x[c(TRUE, FALSE, TRUE, FALSE, TRUE)]
```

如果给每个元素命名，以下方法也将返回相同的值；

混合使用正负值是不允许的，会抛出一个错误，超出范围的下标值不会导致错误，而是返回缺失值 NA。

```{r}
names(x) <- c("one", "four", "nine", "sixteen", "twenty five")
x[c("one", "nine", "twenty five")]
```

<br />
which 函数将返回逻辑向量中为 TRUE 的位置。如果要将逻辑索引切换到整数索引中，这个函数很有用:

```{r}
which(x > 10)

which.min(x)

which.max(x)
```

#### 1.5 循环

- 如果我们把一个单独的数字与向量相加，则向量的每个元素都会与该数字相加:
- 将两个向量相加时，R 将会循环较短向量中的元素以配合较长的那个:
- 如果长向量的长度不是短向量长度的倍数，将出现一个警告:

```{r}
1:5 + 1

1:5 + 1:15

1:5 + 1:7
```

<br />
rep 函数非常适合此类任务，它允许我们重复使用元素来创建矢量:

```{r}
rep(1:5, 3)

rep(1:5, each = 3)

rep(1:5, times = 1:5)

rep(1:5, length.out = 7)
```

### 2. 数组

可以使用 array 函数创建一个数组，为它们传入两个向量(值和维度)作为参数，也可以为每个维度命名；

dim 函数将返回其维度的整数值向量。

```{r}
(three_d_array <- array(
    1:24,
    dim = c(4, 3, 2),
    dimnames =  list(
        c("A1", "A2", "A3", "A4"),
        c("B1", "B2", "B3"),
        c("C1", "C2")
  )
))

dim(three_d_array)

dimnames(three_d_array)
```


### 3. 矩阵
#### 3.1 矩阵的创建
创建矩阵的语法非常类似，但无需传递维度 dim 参数，只要指定行数或列数即可:

创建矩阵时，传入的值会按列填充矩阵。也可指定参数 byrow = TRUE 来按行填充矩阵；

对于矩阵和数组，dim 函数将返回其维度的整数值向量，函数 nrow 和 ncol 将分别返回行数和列数。

```{r}
(a_matrix <- matrix(
    1:12,
    nrow = 4,
    dimnames = list(
        c("one", "two", "three", "four"),
        c("col1", "col2", "col3")
    )
))

matrix(
    1:12,
    nrow = 4,
    byrow = TRUE,
    dimnames = list(
        c("one", "two", "three", "four"),
        c("col1", "col2", "col3")
    )
)

dim(a_matrix)

nrow(a_matrix)

ncol(a_matrix)

rownames(a_matrix)

colnames(a_matrix)
```

<br />
c 函数能在拼接矩阵之前把它们转换成向量:

```{r}
(another_matrix <- matrix(
    seq.int(2, 24, 2),
    nrow = 4,
    dimnames = list(
        c("five", "six", "seven", "eight"),
        c("col1", "col2", "col3")
    )
))

c(a_matrix, another_matrix)
```

#### 3.2 矩阵的索引

索引数组与索引向量类似，只是现在要索引的维度多于一个。和之前一样，我们用方括号 来表示索引，且仍有四种指定索引的方法(正整数、负整数、逻辑值和元素的名称)。在 不同的维度上用不同的方式指定索引下标完全没问题。每个维度的下标用逗号分隔:

```{r}
# 第一行，第二列和第三列的元素
a_matrix[1, c("col1", "col3")]

# 第三行的所有元素
a_matrix[3, ]

# 第二列和第三列的所有元素
a_matrix[, c("col2", "col3")]
```

#### 3.3 矩阵的合并
通过使用 cbind 和 rbind 函数按行和列来绑定两个矩阵，能更自然地合并它们:

```{r}
# 横向合并
cbind(a_matrix, another_matrix)

# 纵向合并
rbind(a_matrix, another_matrix)
```

#### 3.4 矩阵的运算
和向量中的运算一样，标准算术运算符(+、- 、\*、/)将以同样的方式按元素来处理矩阵和数组；

当对两个数组执行算术运算时，须确保它们的行和列是一致的。

```{r}
a_matrix + another_matrix

a_matrix * another_matrix
```

矩阵的乘法、转置和取逆

```{r}
# 矩阵的转置
t(a_matrix)

# 矩阵的乘法
a_matrix %*% t(a_matrix)

square_matrix <- matrix(c(1, 0, 1, 5, -3, 1, 2, 4, 7), nrow = 3)

# 矩阵的取逆
inverse_square_matrix <- solve(square_matrix)

square_matrix %*% inverse_square_matrix
```



